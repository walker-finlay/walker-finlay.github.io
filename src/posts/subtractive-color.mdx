---
slug: "blog/subtractive-color"
date: "2022-01-23"
title: "Subtractive Color"
teaser: "Experimenting with color theory and html canvas elements"
featuredImgUrl: https://images.squarespace-cdn.com/content/v1/583537ea9f745645805f7860/1573067590790-R9VYSU4ER6WRBH9X7W7F/DSC04623.jpg
featuredImgAlt: "Felipe Pantone's Subtractive Variability"
---

import SubtractiveDemo from "../components/SubtractiveDemo";

This mini-project, a variation of which lives in the header bar, was inspired by [Felipe Pantone](https://en.wikipedia.org/wiki/Felipe_Pantone)'s [Subtractive Variability](https://www.felipepantone.com/subtractive-variability) series. Felipe Pantone is an Argentine-Spanish artist known for his “use of bold colors, geometrical patterns and Op Art elements”.[^1] His Subtractive Variability series derives such bold colors from the fundamentals of color theory. 

## Color Theory
Within color theory, color can be classified in one of four ways:

1. Warm and Cold
2. Receding and Advancing
3. Positive and negative
4. Subtractive and additive

Subtractive and additive refer to two models we use to conceptualize color sources, and how colors are mixed on their way to our eye, depending on the model.

#### Subtractive Color 
In the subtractive model, white light hits an object, and certain wavelengths are "subtracted" or absorbed, reflecting only the wavelength(s) which we ultimately assign to that object.

#### Additive Color
If the baseline in subtractive color is white light, something from which to subtract, the baseline in additive color is blackness/absence of light, something to add to. Additive color is modeled as a mix of color emitted from different light sources, each with their own color. 

Web designers use additive color all the time via the rgb color model, because computer and tv pixels emit varying levels of red, blue, and green light.

## Simulation

#### Demo
Move the sliders at the bottom to offset the filters; the button in the top right resets their positions to the center:

<SubtractiveDemo />

The demo above simulates a Felipe Pantone piece in which pieces of glass painted red, green, and blue are placed in front of a backlight. Each is segmented into a range of intensities. The segments are simulated by an RGB to CMYK conversion function $(1)$, a floored $\sin$ function $(2)$, and a matrix `filter_base`, which defines the light blocked by each filter. For example, at $x=0$, the red filter allows $p(0)$ magenta and yellow light to pass through.

$$
\begin{align}
f(x) &= 255(1-x)(1-k) \\
p(x)&=\frac{1}{4}+\frac{1}{4}\sin\left(\frac{2\pi}{w}\left\lfloor\frac{x}{s}\right\rfloor s\right)
\end{align}
$$

Where $w$ is the width of a filter in pixels, and $s$ is the width of a filter segment in pixels. The peak is at $0.5$ because the filters are semi-transparent; that is, when 2 are overlapping, some light still gets through, but when the peak of all 3 overlap, no light gets through, making that segment black.

<iframe src="https://www.desmos.com/calculator/nougdzpiuc" width="100%" style="min-height:400px"></iframe>

When a rectangle is drawn, a final RGB color is determined by:
1. Composing the filter base with the color intensity function $(2)$
2. Clipping channels selectively based on the positions of the filters (if $x$ is outside the filter range, do not consider that filter's contribution to the final color)
3. Summing the columns to get the contribution of each RGB filter to each CMYK channel 
4. Converting CMYK to RGB with equation $(1)$

$$
\underbrace{
\vphantom{
\left(
p(x)
\begin{bmatrix}
0 & 1 & 1 \\
1 & 0 & 1 \\
1 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
clip_r \\
clip_g \\
clip_b
\end{bmatrix}
\right)}
f \circ
}_{4}
\underbrace{
\left(
p(x)
\begin{bmatrix}
0 & 1 & 1 \\
1 & 0 & 1 \\
1 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
clip_r \\
clip_g \\
clip_b
\end{bmatrix}
\right)}_{1 \& 2}
\underbrace{
\vphantom{
\left(
p(x)
\begin{bmatrix}
0 & 1 & 1 \\
1 & 0 & 1 \\
1 & 1 & 0
\end{bmatrix}
\begin{bmatrix}
clip_r \\
clip_g \\
clip_b
\end{bmatrix}
\right)}
\cdot
\begin{bmatrix}
1 & 1 & 1
\end{bmatrix}}_{3}
$$

`SubtractiveDemo.js`
```jsx{numberLines: 90}
ctx.fillStyle = `rgb(${filter_base
  .map(
    (row, idx_rgb) => row.map(
      el => el && clip[idx_rgb] && p(delims[i] - fw / 2 - sliders[idx_rgb], bw, fw)
    )
  )
  .reduce((partial, a) => partial.map((el, idx) => el + a[idx]))
  .map(v => f(v))
})`;
```

[^1]: [https://www.widewalls.ch/artists/felipe-pantone/](https://www.widewalls.ch/artists/felipe-pantone/) 